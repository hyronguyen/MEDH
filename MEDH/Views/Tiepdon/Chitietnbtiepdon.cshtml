@{
    ViewData["Title"] = "Chi tiết tiếp đón";
    @model ChitietTiepdonViewModel


}

<link rel="stylesheet" href="~/css/tiepdonStyles/chitiettiepdon.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<div class="container mt-4">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-area="" asp-controller="Home" asp-action="Index">Trang chủ</a></li>
            <li class="breadcrumb-item"><a>Tiếp đón</a></li>
            <li class="breadcrumb-item"><a asp-area="" asp-controller="Tiepdon" asp-action="Dstiepdon">Danh sách tiếp đón</a></li>
            <li class="breadcrumb-item active">@Model.MaHoSo</li>
        </ol>
    </nav>

    <h2 class="mb-4 text-primary">Chi tiết tiếp đón</h2>

    <!-- Section 1: Thông tin hành chính -->
    <div class="card mb-4">
        <div class="card-header bg-primary">
            Thông tin hành chính
        </div>
        <div class="card-body row g-3">
            <div class="col-md-4">
                <label class="form-label fw-bold">Mã hồ sơ:</label>
                <div>@Model.MaHoSo</div>
            </div>
            <div class="col-md-4">
                <label class="form-label fw-bold">Họ tên:</label>
                <div><span class="text-muted">@Model.HoTen</span></div>
            </div>
            
            <!--format ngày sính -->
            @{
                var ngaySinhText = Model.NgaySinh.HasValue 
                    ? Model.NgaySinh.Value.ToString("dd/MM/yyyy") 
                    : "Không rõ";
            }

            <div class="col-md-4">
                <label class="form-label fw-bold">Năm sinh:</label>
                <div><span class="text-muted">@ngaySinhText</span></div>
            </div>

            <div class="col-md-4">
                <label class="form-label fw-bold">Giới tính:</label>
                <div><span class="text-muted">@(Model.GioiTinh == "M" ? "Nam" : Model.GioiTinh == "F" ? "Nữ" : "Khác")</span></div>
            </div>
            <div class="col-md-4">
                <label class="form-label fw-bold">Địa chỉ:</label>
                <div><span class="text-muted">@Model.DiaChi</span></div>
            </div>
        </div>
    </div>

    <!-- Section 2: Danh sách dịch vụ đã kê -->
    <div class="card mb-4">
        <div class="card-header bg-secondary">
            Danh sách dịch vụ đã kê
        </div>
        <div class="card-body table-responsive">
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Mã dịch vụ</th>
                        <th>Tên dịch vụ</th>
                        <th>Ngày thực hiện</th>
                        <th>Thành tiền</th>
                        <th>Thanh toán</th>
                        <th>Trạng thái</th>
                        <th> </th>
                    </tr>
                </thead>
                @foreach (var dv in Model.DichVus)
                {
                <tr>
                    <td>#</td>
                    <td>@dv.MaDichVu</td>
                    <td>@dv.TenDichVu</td>
                        <td>@dv.NgayThucHien</td>
                       <td>@dv.ThanhTien</td>
                    <td>@dv.ThanhToan</td>
                   <td>
                            @switch (dv.TrangThai)
                            {
                                case "cho_thuc_hien":
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-hourglass-start me-1"></i>Chờ thực hiện
                                    </span>
                                    break;
                                case "dang_thuc_hien":
                                    <span class="badge bg-warning text-dark">
                                        <i class="fa fa-clock me-1"></i>Đang thực hiện
                                    </span>
                                    break;
                                case "da_thuc_hien":
                                    <span class="badge bg-success">
                                        <i class="fas fa-check-circle me-1"></i>Đã thực hiện
                                    </span>
                                    break;
                                case "huy":
                                    <span class="badge bg-danger">
                                        <i class="fas fa-times-circle me-1"></i>Hủy
                                    </span>
                                    break;
                                default:
                                    <span class="badge bg-light text-muted">
                                        Không rõ
                                    </span>
                                    break;
                            }

                    </td>
                        <td>
                            @if (dv.TrangThai == "cho_thuc_hien")
                            {
                                <button class="btn btn-outline-danger btn-sm" title="Xóa dịch vụ" onclick="XoaDichVu('@dv.MaDichVuKham')">
                                    <i class="fas fa-trash"></i> Xóa
                                </button>
                            }
                        </td>

                </tr>
                        }
                        @if (!Model.DichVus.Any())
                        {
                <tr>
                    <td colspan="8" class="text-center text-muted">Chưa có dịch vụ nào được kê</td>
                </tr>
                }
            </table>
        </div>
    </div>

    <!-- Nút chức năng -->
    <div class="mb-5">
        <a asp-controller="Tiepdon"
           asp-action="Kedichvutiepdon"
           asp-route-maHS="@Model.MaHoSo"
           class="btn btn-success me-2">
            <i class="bi bi-plus-circle"></i> Kê thêm dịch vụ
        </a>
        <a asp-controller="Tiepdon"
           asp-action="HuyTiepdon"
           asp-route-maHS="@Model.MaHoSo"
           class="btn btn-danger">
            <i class="bi bi-x-circle"></i> Hủy tiếp đón
        </a>
    </div>
</div>
